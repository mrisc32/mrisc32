% -*- mode: latex; tab-width: 2; indent-tabs-mode: nil; -*-
%------------------------------------------------------------------------------
% MRISC32 ISA Manual - Base architecture.
%
% This work is licensed under the Creative Commons Attribution-ShareAlike 4.0
% International License. To view a copy of this license, visit
% http://creativecommons.org/licenses/by-sa/4.0/ or send a letter to
% Creative Commons, PO Box 1866, Mountain View, CA 94042, USA.
%------------------------------------------------------------------------------

\chapter{Base architecture}

The Base architecture is present in all implementations of the MRISC32 ISA. It
primarily provides scalar integer and control flow instructions, and
constitutes the minimum requirement for an MRISC32 implementation.

\section{Scalar registers}

There are 32 user addressable scalar registers, each 32 bits wide.

\begin{bytefield}{32}
  \bitheader{0,31} \\
  \wordbox{1}{Z (R0)} \\
  \wordbox{1}{R1} \\
  \wordbox{1}{R2} \\
  \wordbox[]{1}{$\vdots$} \\[1ex]
  \wordbox{1}{R25} \\
  \wordbox{1}{R26} \\
  \wordbox{1}{TP (R27)} \\
  \wordbox{1}{FP (R28)} \\
  \wordbox{1}{SP (R29)} \\
  \wordbox{1}{LR (R30)} \\
  \wordbox{1}{VL (R31)}
\end{bytefield}

\subsection{The Z register}

Z is a read-only register that is always zero. Writing to the Z register has no
effect.

\subsection{The LR register}

LR is the link register, which contains the return address for subroutines. It
can also be used as a general purpose register.

\subsection{The VL register}

VL is the vector length register, which defines the length of vector
operations. It can also be used as a general purpose register when its value
is not used by any vector operations.

If an implementation does not supprot the Vector operation module
(\hyperref[module:VM]{VM}), the VL register acts as a regular general purpose
register.

\subsection{TP, FP and SP}

The scalar registers TP, FP and SP are aliases for R27, R28 and R29,
respectively. They have no special architectural meaning, but it is recommended
that they are used as follows:

\begin{tabular}{|l|l|}
  \hline
  \textbf{Name} & \textbf{Description} \\
  \hline
  TP & Thread pointer (for thread local storage) \\
  \hline
  FP & Frame pointer \\
  \hline
  SP & Stack pointer \\
  \hline
\end{tabular}

The registers can also be used as general purpose registers.

\section{The program counter}

The program counter (PC) is an internal register that holds the memory address
of the current instruction. There are a few instructions that make use of the
value of the program counter, either directly or indirectly, but other
instructions can neither read nor alter the program counter.

\section{Memory addressing}

\tbd

\section{Exceptions}

\tbd
