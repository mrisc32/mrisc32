% -*- mode: latex; tab-width: 2; indent-tabs-mode: nil; -*-
%------------------------------------------------------------------------------
% MRISC32 ISA Manual - Instructions.
%
% This work is licensed under the Creative Commons Attribution-ShareAlike 4.0
% International License. To view a copy of this license, visit
% http://creativecommons.org/licenses/by-sa/4.0/ or send a letter to
% Creative Commons, PO Box 1866, Mountain View, CA 94042, USA.
%------------------------------------------------------------------------------

\chapter{Instructions}

This chapter describes all the instructions of the MRISC32 instruction set.

Instruction variants with a .B (packed byte) or .H (packed half-word) mnemonic
suffix are only available in implementations that support the Packed operation
module (\hyperref[module:PM]{PM}).

Instruction variants that include vector register operands are only available
in implementations that support the Vector operation module
(\hyperref[module:VM]{VM}).

For instructions that are not part of the Base architecture, the required
architecture module (or modules) is indicated in the instruction documentation.

The encoding format used for immediate operands is documented per instruction
(the IM field, if any, references the immediate encoding format).

\section{Pseudocode syntax}

The operation that an instruction performs is described using pseudocode.

\subsection{Pseudocode scope}

The pseudocode for each instruction shall be regarded as a function that is
executed for each chunk of each element of the operation.

For a scalar operation, there is only a single element.

For a vector operation, the number of elements is dictated by the vector
operation.

The number of chunks and the size of each chunk is dictated by the packed
operation mode.

\begin{todobox}
Describe different types that are used in the pseudocode, such as
"bit vector", "integer", "unsigned integer" and "float"?

Come up with a better name than "chunk"?
\end{todobox}

\subsection{Numeric constants}

Unless otherwise noted, numeric constants are given as decimal (base 10)
integers.

Integers in other bases are given as $N_{base}$ (e.g. $101_{2}$).

\subsection{Notation}

The following notation is used in the pseudocode that describes the operation
of an instruction:

\begin{tabular}{lp{400pt}}
\textbf{Notation} & \textbf{Meaning} \\
x<$k$> & Bit $k$ of bit vector x \\
x<$k$:$l$> & Bits $k$ to $l$ of bit vector x \\
MEM[x,N] & $N$ consecutive bytes in memory starting at address $x$, interpreted as an $8\times N$-bit vector with little endian storage \\
SR[x] & System register number $x$ \\
a & 1st instruction operand \\
b & 2nd instruction operand \\
c & 3rd instruction operand \\
IM & IM field of the instruction word \\
T & T field of the instruction word \\
V & Vector mode (two bits) \\
bits & Chunk size, in bits \\
scale & Scale factor according to the T field (1 for format C instructions) \\
i & Vector element number \\
$\leftarrow$ & Assignment \\
+, - & Addition, Subtraction \\
$\times$, / & Multiplication, Division \\
\% & Remainder of integer division \\
$=$, $\neq$ & Equal, Not equal \\
$<$, $>$ & Less than, Greater than \\
$\leq$, $\geq$ & Less than or equal, Greater than or equal \\
$\neg$, $\vee$, $\wedge$ & Logical NOT, OR, AND \\
\textasciitilde, $|$, \&, \textasciicircum & Bitwise NOT, OR, AND, XOR \\
$<<$, $>>$ & Zero-fill left-shift, right-shift \\
$<<_{s}$, $>>_{s}$ & Sticky left-shift (fill with LSB), right-shift (fill with MSB) \\
ones(N) & Bit vector of $N$ 1-bits \\
zeros(N) & Bit vector of $N$ 0-bits \\
int(x) & Interpret bit vector $x$ as a two's complement signed integer \\
uint(x) & Interpret bit vector $x$ as an unsigned integer \\
float(x) & Interpret bit vector $x$ as a floating-point number \\
max(x,y) & Maximum value of $x$ and $y$ \\
min(x,y) & Minimum value of $x$ and $y$ \\
sat(x,N) & Saturate integer $x$ to the range $[-2^{N-1},2^{N-1})$ \\
satu(x,N) & Saturate integer $x$ to the range $[0,2^{N})$ \\
isnan(x) & True if $x$ is not a number (NaN) \\
\end{tabular}

\clearpage

\input{build/gen-instructions}
